<!DOCTYPE html>
<html>
  <head>
    <title>Examples of calling asynchronous JavaScript functions</title>
    <meta charset="UTF-8" />
  </head>
  <body>
    <nav>
      <a href="index.html">home</a> &mdash;
      <a href="0-synchronous.html">synchronous JS</a> &mdash;
      <a href="1-callbacks.html">callback functions</a> &mdash;
      <a href="2-promises.html">promises with .then()</a> &mdash;
      <a href="3-asyncawait.html">promises with async/await</a> &mdash;
      <a href="4-promises2.html">multiple promises with .then()</a> &mdash;
      <a href="5-asyncawait2.html">multiple promises with async/await</a> &mdash;
      <a href="fetch1.html">fetch with then()</a> &mdash;
      fetch with async/await
    </nav>
    <hr/>
    <button id="btn">get data using fetch / process it with async/await</button>
    <hr/>
    <script>
      function fetchData() {
        let url = "https://gorest.co.in/public-api/users";
        usingAsyncAwait(url);
      }

      async function usingAsyncAwait(url) {
        try {
          const response = await fetch(url);
          const responseAsJSON = response.ok ? await response.json() : null;
          const data = responseAsJSON && responseAsJSON.data;

          // let data;
          // if (responseAsJSON === null) {
          //   data = null;
          // } else {
          //   data = responseAsJSON.data;
          // }

          if (data) {
            console.log(data);
          } else {
            throw new Error('problem with request')
          }
        } catch (error) {
          console.error(error.message);
        }
      }

      document.getElementById('btn').addEventListener('click', fetchData);
    </script>
  </body>
</html>
